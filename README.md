# æ·±åº¦å­¦ä¹ ã€å›¾åƒå¤„ç†é¢†åŸŸå¿…å­¦ç»å…¸ç®—æ³•ï¼šLeNetã€AlexNETã€GoogLeNetã€VGGã€ResNetç®—æ³•çš„å®žçŽ°

## å®žéªŒç»“æžœ

å…ˆä¸Šç»“æžœï¼šæ‰€æœ‰ç»“æžœå‡åœ¨[Kaggle](https://www.kaggle.com/)å¹³å°ä¸Šè¿è¡ŒèŽ·å¾—çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªå…è´¹è¯•ç”¨GPUçš„å¹³å°æ˜¯[Google colab](https://colab.research.google.com/)ã€‚å¼ºçƒˆæŽ¨èï¼Œç¬”è®°æœ¬é…ç½®ä¸å¤Ÿçš„åŒå­¦ä½¿ç”¨è¿™ä¸¤ä¸ªå¹³å°è¿›è¡Œå­¦ä¹ ï¼ŒKaggleæ¯å‘¨å›ºå®šæ—¶é•¿çš„ï¼Œä¸€èˆ¬ä¸º36åˆ°40å¤šå°æ—¶ã€‚colabæ£€æµ‹åˆ°ä½ ç»å¸¸åœ¨ç”¨GPUçš„è¯ä¼šä¸ç»™ä½ åˆ†é…GPUï¼Œä»–ä¼šé¦–å…ˆå°†GPUåˆ†é…ç»™ç”¨çš„å°‘çš„è´¦æˆ·ã€‚

* å„ä¸ªæ¨¡åž‹çš„å‡†ç¡®çŽ‡ accï¼š  
  
  * LeNetï¼ˆcifar10ï¼‰ï¼š0.6413ï¼ˆ500æ¬¡è¿­ä»£ï¼Œæ¨¡åž‹å¥½åƒè¿˜æ²¡æ”¶æ•›ï¼‰
  
  * AlexNetï¼š0.6594ï¼ˆ289æ¬¡è¿­ä»£ï¼‰
  
  * GoogLeNetï¼š0.7617ï¼ˆ127æ¬¡è¿­ä»£ï¼‰  
  
  * VGG16ï¼š0.8172ï¼ˆ116æ¬¡è¿­ä»£ï¼‰  
  
  * VGG19ï¼š0.8203ï¼ˆ72æ¬¡è¿­ä»£ï¼‰  
  
  * Res18ï¼š0.7141ï¼ˆ44æ¬¡è¿­ä»£ï¼‰  
  
  * Res34ï¼š0.7336ï¼ˆ169æ¬¡è¿­ä»£ï¼‰  
  
  * Res50ï¼š0.7093ï¼ˆ115æ¬¡è¿­ä»£ï¼‰  
  
  * Res101ï¼š0.6656ï¼ˆ100æ¬¡è¿­ä»£ï¼Œaccè¿˜å‘ˆä¸Šå‡è¶‹åŠ¿ï¼‰  
  
  * Res152ï¼š0.6500ï¼ˆ72æ¬¡è¿­ä»£ï¼‰  

* å…¶ä¸­ï¼ŒResNetç³»åˆ—æ™®ééƒ½æ”¶æ•›çš„æ¯”è¾ƒå¿«ï¼Œå‡ ä¹Žéƒ½åœ¨10æ¬¡è¿­ä»£å°±è¾¾åˆ°accï¼š0.5ï¼›30~40æ¬¡è¿­ä»£è¾¾åˆ°accï¼š0.6ï¼ŒåŽé¢å°±å‡ºçŽ°äº†æ³¢åŠ¨çŽ°è±¡ï¼Œè€Œä¸”æ³¢åŠ¨èŒƒå›´æ¯”è¾ƒå¤§ï¼Œæœ‰æ—¶ç”šè‡³ä¼šå‡ºçŽ°accä¸‹é™0.3å·¦å³ã€‚ä¸ªäººè§‚ç‚¹æ˜¯ResNetç®—æ³•çš„æ¢¯åº¦æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ¨¡åž‹è°ƒæ•´å¾—æ¯”è¾ƒå¿«ï¼Œä½†åŒæ—¶æœ‰ä¸ªé—®é¢˜æ˜¯è°ƒæ•´è¿‡å¿«å®¹æ˜“åœ¨æœ€ä¼˜å€¼é™„è¿‘éœ‡è¡ã€‚è¿˜æœ‰çš„è¯ï¼Œæˆ‘åšçš„ä»»åŠ¡æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ˆ10åˆ†ç±»ä»»åŠ¡ï¼‰ï¼Œç”¨ResNetç³»åˆ—çš„æ¨¡åž‹å°±æœ‰ç§å¤§æå°ç”¨çš„æ„Ÿè§‰ï¼Œå°±æ˜¯åˆ†ç±»ä»»åŠ¡å¾ˆç®€å•ï¼Œå¤æ‚çš„æ¨¡åž‹ç”¨åœ¨ç®€å•çš„é—®é¢˜ä¸Šæ•ˆæžœå¹¶ä¸å¥½ã€‚åŽç»­æˆ‘ä¹Ÿåšäº†å®žéªŒï¼Œä½¿ç”¨æ®‹å·®ç»“æž„æ­å»º10å±‚ã€14å±‚ã€16å±‚ã€26å±‚çš„æ¨¡åž‹åˆ†åˆ«å¾—åˆ°çš„accï¼ˆè¿­ä»£å‡å°‘äºŽ100æ¬¡ï¼Œå¤§æ¦‚åœ¨50åˆ°80æ¬¡ä¹‹é—´å°±å¯å¾—åˆ°æœ€ä¼˜å€¼ï¼‰ä¸º0.7094ï¼Œ0.7383ï¼Œ0.7406ï¼Œ0.7289ã€‚ä»Žæ•°æ®ä¸Šçœ‹ï¼Œå¯çŸ¥åœ¨ä¸€ä¸ªæ¯”è¾ƒæµ…å±‚çš„ç½‘ç»œï¼ˆå¦‚14ã€16å±‚ï¼‰ï¼Œå®ƒçš„æ•ˆæžœå·²ç»æ˜¯å¯ä»¥è¾¾åˆ°0.74å·¦å³äº†ï¼Œè€ŒåŽé¢å†åŠ æ·±æ¨¡åž‹å±‚æ•°ï¼ŒåƒRes34æ¨¡åž‹ä¸€ç›´åœ¨æœ€ä¼˜å€¼å·¦å³éœ‡è¡ï¼Œå‡†ç¡®çŽ‡ä¸Šå‡ç¼“æ…¢ç›´åˆ°169æ¬¡æ‰è¾¾åˆ°æœ€å¥½çš„ç»“æžœã€‚è€Œåœ¨åŽé¢Res50ã€Res101ã€Res152å¯ä»¥çœ‹åˆ°è®­ç»ƒé€Ÿåº¦ä¾æ—§æ˜¯æŒºå¿«çš„ï¼Œä½†æ˜¯å‡†ç¡®çŽ‡ä¸‹é™å¾—æ˜Žæ˜¾ï¼Œä»Ž0.74ä¸€ç›´ä¸‹é™åˆ°0.65ï¼Œå°±æ˜¯æ¨¡åž‹å¤æ‚å­¦åˆ°çš„ä¸œè¥¿è¶…è¿‡è¿™ä¸ª10åˆ†ç±»ä»»åŠ¡éœ€è¦çš„ï¼Œè‡´ä½¿åˆ†ç±»é”™è¯¯çŽ‡ä¸Šå‡äº†ã€‚

* åŒæ—¶ï¼Œæ¯”è¾ƒæƒŠè®¶çš„æ˜¯æ‰€æœ‰ç»“æžœä¸­ï¼ŒVGGç½‘ç»œçš„æ•ˆæžœæ˜¯æœ€å¥½çš„ï¼Œåœ¨ImageNetçš„æ¯”èµ›ä¸­GoogLeNetå’ŒResNetçš„æ•ˆæžœéƒ½æ˜¯æ¯”VGGè¦å¥½çš„ã€‚è¿™ä¸ªæˆ‘ä¸ªäººçŒœæµ‹æ˜¯æˆ‘ä½¿ç”¨çš„è®­ç»ƒæ•°æ®é‡ä¸å¤Ÿï¼Œè¿˜æœ‰å®žéªŒè¿‡ç¨‹ä¸­æ¯”æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œä»»ä½•æ•°æ®å¢žå¼ºçš„æ“ä½œï¼Œè¿˜æœ‰ä¸€ä¸ªåŽŸå› å¯èƒ½æ˜¯æˆ‘å°†å›¾ç‰‡resizeæˆäº†112$\times$112ï¼ˆé—®å°±æ˜¯æˆ‘å†…å­˜ä¸å¤Ÿï¼Œä¸ºäº†è®­ç»ƒæ•°æ®é›†å°½å¯èƒ½åœ°å¤§ï¼Œåªèƒ½å°†å°ºå¯¸é™ä¸‹æ¥ï¼‰ï¼Œè€ŒåŽŸè®ºæ–‡ç®—æ³•ä¸­ç”¨çš„éƒ½æ˜¯224$\times$224çš„ã€‚

## æ•°æ®é›†

* ImageNetå°éƒ¨åˆ†æ•°æ®é›†ï¼ˆ17å„ç±»åˆ«ï¼‰ï¼šimages_setæ–‡ä»¶å¤¹ä¸ºImageNet2012æ•°æ®é›†çš„ä¸€å°éƒ¨åˆ†ï¼Œå…±æœ‰17ç±»å›¾ç‰‡æ•°æ®ï¼Œæ¯ç±»å›¾ç‰‡æœ‰1000åˆ°1500å¼ ä¸ç­‰ã€‚å¯¹åº”ä¸ºæ–‡ä»¶å¤¹ä¸‹æ¯ä¸€ä¸ªå­æ–‡ä»¶å¤¹ä¸º1ç±»å›¾ç‰‡æ•°æ®ï¼Œå­æ–‡ä»¶å¤¹åå­—ä¸ºç±»åï¼ŒåŽé¢çš„æ•°å­—ä¸ºå›¾ç‰‡çš„æ•°é‡ã€‚
  
  * ImageNetæ›´å¤šæ•°æ®æŽ¨èåŽ»[å®˜ç½‘](https://image-net.org/request)è¿›è¡Œä¸‹è½½
  
  * è¿™é‡Œæœ‰ä¸€ä¸ªä¸“é—¨é’ˆå¯¹ImageNetçš„[GitHubå¼€æºçˆ¬è™«é¡¹ç›®](https://github.com/mf1024/ImageNet-Datasets-Downloader)ï¼Œä¹Ÿå¯ä»¥èŽ·å¾—ImageNetæ•°æ®
  
  * [Kaggle](https://www.kaggle.com/datasets/lijiyu/imagenet)ä¸Šä¹Ÿæœ‰ImageNetçš„ä¸€äº›å°æ•°æ®é›†ï¼ˆ7Gï¼‰ï¼Œå¤Ÿæˆ‘ä»¬åšå°é¡¹ç›®ç”¨äº†

* cifar10æ•°æ®é›†ï¼šè¿™é‡ŒåŽŸæœ¬æ˜¯ä¸ç”¨cifaræ•°æ®çš„ï¼Œä½†æ˜¯ä¸»è¦æ˜¯LeNetç½‘ç»œç»“æž„å¤ªç®€å•äº†ï¼Œæ¨¡åž‹çš„è¡¨è¾¾èƒ½åŠ›æœ‰é™ï¼Œåœ¨ImageNetæ•°æ®ä¸Šå‡ ä¹Žä¸èµ·ä½œç”¨ï¼Œçœ‹ä¸ªæ•°æ®å°±çŸ¥é“äº†:ç”¨ImageNetæ•°æ®é›†10ä¸ªÂ·ç±»åˆ«è®­ç»ƒLeNetç½‘ç»œï¼ˆ1000æ¬¡è¿­ä»£ï¼‰è®­ç»ƒå’Œé¢„æµ‹çš„accä¾æ—§åªæœ‰0.1å·¦å³ã€‚å¼€å§‹è®­ç»ƒæ—¶ä¹Ÿæ˜¯0.1ã€‚

# Quick Start Examples

* é¦–å…ˆè¿›å…¥åˆ°é¡¹ç›®æ‰€åœ¨çš„ç›®å½•ï¼Œæ£€æŸ¥çŽ¯å¢ƒå’Œå¯¹ç›¸å…³çš„åŒ…æ˜¯å¦æ»¡è¶³ç‰ˆæœ¬è¦æ±‚
  
  å¯ä»¥ç›´æŽ¥ä½¿ç”¨`pip install -r requirements.txt`è¿›è¡Œæ£€æŸ¥ï¼Œä¸ç¬¦åˆçš„è¯è·µè¡Œå®‰è£…ï¼Œç¬¦åˆçš„ä»–ä¼šå‘Šè¯‰ä½ è¯¥åŒ…å·²ç»æ»¡è¶³ç›¸åº”ç‰ˆæœ¬ã€‚

* è¿è¡Œä»£ç 
  
  * åœ¨cmdä¸‹è¿è¡Œ
  
  ```python
  python run.py --model Res34 --optimizer adam --dataset images_set --project ./run --batch_size 128 --epochs 128 
  # model å¯é€‰Lenet5ã€Alexnet8ã€GoogLeNetã€VGG16ã€VGG19ã€Res18ã€Res34ã€Res50ã€Res101ã€Res152
  # optimizer ä¼˜åŒ–å™¨ï¼Œå¯é€‰adamã€sgdã€nadamã€adagradç­‰ç­‰
  # dataset å¯é€‰images_setã€cifar10
  # project é€‰æ‹©è¦å°†æ¨¡åž‹çš„checkpointsæ–‡ä»¶weightsæ–‡ä»¶ä¿å­˜çš„ç›®å½•
  # batch_size int æ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°
  # epochs int è¿­ä»£æ¬¡æ•°
  ```
  
  * IDLEä¸­è¿è¡Œï¼Œå¦‚pycharm
    
    ä¿®æ”¹run.pyä¸­parseé‡Œçš„å‚æ•°å³å¯ï¼Œå„å‚æ•°å¯é€‰ä¸Žcmdä¸‹è¿è¡Œä¸€è‡´ã€‚

## ç›¸å…³è®ºæ–‡å‚è€ƒæ–‡çŒ®

* Â Â Â Â åœ¨æœ€åŽï¼Œç»™å¤§å®¶é™„ä¸Šç›¸å…³è®ºæ–‡çš„é“¾æŽ¥ï¼Œå…¶ä¸­LeNetæœ‰ç‚¹ä¹…è¿œäº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œåˆ°ç½‘ä¸Šæ‰¾ã€‚

* [**AlexNetè®ºæ–‡é“¾æŽ¥ï¼šImageNet Classification with Deep Convolutional Neural Networks**](https://papers.nips.cc/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf)

* [**Dropoutè®ºæ–‡é“¾æŽ¥ï¼šSrivastava, Nitish, et al. "Dropout: a simple way to prevent neural networks from overfitting." Journal of Machine Learning Research 15.1 (2014): 1929-1958.**](https://dl.acm.org/doi/abs/10.5555/2627435.2670313)

* [**BNè®ºæ–‡é“¾æŽ¥ï¼šIoffe, Sergey, and Christian Szegedy. "Batch normalization: Accelerating deep network training by reducing internal covariate shift." arXiv preprint arXiv:1502.03167 (2015)**](https://arxiv.org/abs/1502.03167)

* **[GoogLeNetè®ºæ–‡é“¾æŽ¥ï¼šSzegedy, Christian, et al. "Going deeper with convolutions." Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition. 2015.](https://arxiv.org/abs/1409.4842)**

* **[VGGè®ºæ–‡é“¾æŽ¥ï¼šSimonyan, Karen, and Andrew Zisserman. "Very deep convolutional networks for large-scale image recognition." arXiv preprint arXiv:1409.1556 (2014).](https://arxiv.org/abs/1409.1556)**

* [**ResNetè®ºæ–‡é“¾æŽ¥ï¼šHe, Kaiming, et al. "Deep residual learning for image recognition." Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition. 2016.**](https://arxiv.org/abs/1512.03385)

* [**YOLOv5é¡¹ç›®é“¾æŽ¥ï¼šultralytics/yolov5: YOLOv5 ðŸš€ in PyTorch > ONNX > CoreML > TFLite (github.com)**](https://github.com/ultralytics/yolov5)
